<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT"
      crossorigin="anonymous"
    />
    <title>Gestión de Inventario</title>
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="mb-4 text-center">Gestión de Inventario</h1>
      <form class="row g-3 justify-content-center">
        <div class="col-auto">
          <label for="buscar" class="col-form-label">Buscar:</label>
        </div>
        <div class="col-auto">
          <input
            type="text"
            id="buscar"
            class="form-control form-control-lg input-grande"
            placeholder="Ingrese término de búsqueda"
          />
        </div>
        <div class="col-auto">
          <button type="button" class="btn btn-primary btn-lg" id="btnBuscar">
            Buscar
          </button>
        </div>
      </form>

      <!-- Aquí se mostrarán los resultados -->
      <div id="resultado" class="mt-4"></div>
    </div>

    <script>
      document
        .getElementById("btnBuscar")
        .addEventListener("click", function () {
          const codigo = document.getElementById("buscar").value.trim();
          if (!codigo) {
            document.getElementById("resultado").innerHTML =
              '<div class="alert alert-warning">Por favor ingrese un código de producto.</div>';
            return;
          }
          fetch(`/api/producto/${codigo}`)
            .then((response) => response.json())
            .then((data) => {
              let html = "";
              if (data.error) {
                html = `<div class="alert alert-danger">${data.error}</div>`;
              } else {
                html = `
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">${data.nombre}</h5>
                                    <p class="card-text">
                                        <strong>Código:</strong> ${data.codigo}<br>
                                    </p>
                                    <h6>Sucursales:</h6>
                                    <ul>
                        `;
                data.sucursales.forEach((suc) => {
                  html += `
                                <li>
                                    <strong>Sucursal:</strong> ${suc.sucursal} |
                                    <strong>Cantidad:</strong> ${suc.cantidad} |
                                    <strong>Precio:</strong> $${suc.precio}
                                </li>
                            `;
                });
                html += `
                                    </ul>
                                </div>
                            </div>
                        `;
              }
              document.getElementById("resultado").innerHTML = html;
            })
            .catch((error) => {
              document.getElementById(
                "resultado"
              ).innerHTML = `<div class="alert alert-danger">Error al consultar el producto.</div>`;
            });
        });
    </script>
  </body>
</html>
